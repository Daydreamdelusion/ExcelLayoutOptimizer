# Excel美化系统测试用例

## 测试数据示例

### 财务报表测试数据
```
项目名称          1月销售额    2月销售额    3月销售额    季度总计    增长率
产品A              125000      132000      -5000      252000     -2.1%
产品B                   0      245000      280000     525000     14.3%
产品C              189000      189000      189000     567000      0.0%
产品D              -12000       45000       67000     100000    558.3%
                                                                ERROR
合计               302000      611000      531000    1444000      7.6%
```

### 学生成绩测试数据
```
学号        姓名      语文    数学    英语    总分    平均分    排名
2023001    张三       85      92      78      255     85.0      3
2023002    李四       92      85      92      269     89.7      1
2023003    王五       78      78      85      241     80.3      5
2023004    赵六       85      85      85      255     85.0      3
2023005    钱七              95      88      183     61.0      ERROR
2023006    孙八       95      92      95      282     94.0      ERROR
```

### 库存管理测试数据
```
商品编码      商品名称        库存数量    单价     总价值    库存状态    最后入库
SKU001       iPhone 15         125      6999    874875    正常       2024/3/15
SKU002       iPad Pro           0       8999         0    缺货       2024/2/28
SKU003       MacBook Air       45      9999    449955    正常       2024/3/20
SKU004       Apple Watch      -5       3999    -19995    异常       2024/3/18
SKU005       AirPods Pro       88      1999    175912    正常       
SKU006       Mac Studio        12     14999    179988    正常       2024/3/22
```

## 预期美化效果

### 表头美化
- **背景色**：深蓝色 RGB(30, 58, 138)
- **字体**：微软雅黑，11号，加粗，白色
- **对齐**：居中对齐
- **边框**：底部双线，深蓝色

### 数据区域
- **字体**：微软雅黑，10号
- **数值列**：Consolas等宽字体，右对齐
- **边框**：外框深灰色粗线，内网格浅灰色细线

### 条件格式效果
1. **错误值**：ERROR → 浅红背景 + 深红字体
2. **空值**：空单元格 → 浅灰背景  
3. **重复值**：重复的85分 → 浅黄背景
4. **负数**：-5000, -12000, -5, -19995 → 红色字体

### 斑马条纹
- **小表格**（<50行）：每行交替浅蓝色背景
- **中表格**（50-200行）：每2行交替
- **大表格**（>200行）：每3行交替

## 测试步骤

### 1. 准备测试数据
1. 新建Excel工作表
2. 复制上述任一测试数据到A1单元格开始粘贴
3. 确保数据格式正确（注意ERROR、空值、负数）

### 2. 导入美化系统
1. 按 Alt+F11 打开VBA编辑器
2. 导入 ExcelBeautifier.bas 文件
3. 关闭VBA编辑器

### 3. 执行美化
1. 选择包含数据的区域（可选）
2. 按 Alt+F11 再按 Ctrl+G 打开立即窗口
3. 输入 `BeautifyTable()` 回车执行
4. 观察美化效果

### 4. 测试撤销
1. 在立即窗口输入 `UndoBeautify()` 回车
2. 确认所有美化效果被完全撤销
3. 确认原有数据和格式完好无损

### 5. 测试系统功能
```vba
' 运行完整测试
TestBeautifier()

' 显示系统信息  
ShowSystemInfo()
```

## 验证清单

### ✅ 表头识别
- [ ] 自动识别第一行为表头
- [ ] 表头应用深蓝色背景和白色字体
- [ ] 表头底部有双线分隔

### ✅ 条件格式
- [ ] ERROR单元格显示红色背景和字体
- [ ] 空值单元格显示灰色背景
- [ ] 重复值（如成绩85）显示黄色背景
- [ ] 负数显示红色字体

### ✅ 边框样式
- [ ] 外边框为深灰色粗线
- [ ] 内部网格为浅灰色细线
- [ ] 表头底部为深蓝色双线

### ✅ 字体优化
- [ ] 中文使用微软雅黑字体
- [ ] 数值列使用Consolas等宽字体
- [ ] 数值列右对齐显示

### ✅ 斑马条纹
- [ ] 数据行交替显示浅蓝色背景
- [ ] 步长根据表格大小自适应

### ✅ 撤销功能
- [ ] 撤销后所有美化效果消失
- [ ] 原始数据和格式保持不变
- [ ] 无残留的条件格式规则

## 性能测试

### 大表格测试
创建包含以下规模的测试数据：
- **小表格**：10行 × 5列
- **中表格**：100行 × 10列  
- **大表格**：5000行 × 15列
- **超大表格**：15000行 × 20列

观察不同规模下的：
- 执行时间
- 内存占用
- 斑马条纹步长调整
- 性能模式自动启用

### 预期性能指标
| 规模 | 预期执行时间 | 性能模式 | 斑马条纹步长 |
|------|-------------|----------|-------------|
| 小表格 | <1秒 | 关闭 | 1行 |
| 中表格 | 1-3秒 | 关闭 | 2行 |
| 大表格 | 3-10秒 | 关闭 | 3行 |
| 超大表格 | 10-30秒 | 开启 | 关闭斑马纹 |

---

**注意**：测试过程中如遇到问题，请参考 README.md 中的故障排除章节。
